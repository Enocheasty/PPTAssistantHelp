<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <title>绘图-PPT助手使用说明</title>
        <meta name="description" content="An interactive getting started guide for Brackets.">
        <link rel="stylesheet" href="main.css">
    </head>
    <body>
        <h2>绘图</h2>
        <p>Ribbon菜单<strong>PPT助手</strong>中如下图所示部分可对图形对象进行部分编辑操作。</p>
        <img alt="" src="images/02001.png" />
        
        <h4>图形编辑</h4>
        <img class="leftImg" alt="" src="images/02002.png" />
        <p><strong>转曲线、转折线功能</strong> 将PowerPoint绘制的多段线、曲线、自动图形对象中的直线段或曲线段进行相互转换。对于直线段而言，将在直线段两端之间插入控制点，形成三阶贝塞尔曲线样式；对于曲线而言，则将直接移除控制点，直接将曲线起始点坐标相连成直线。因此相互转换中，原则上位置结点坐标不变。需要注意的是，自动图形无论是转为曲线还是转为折线，均会使对象类型变为曲线类型，从而失去调节功能（自动图形常常配有调节功能，用于调节图形的尺寸外观）。将转为曲线功能应用于自动图形，有时候会获得一些有趣的图形样式。</p>
        <p><strong>原位复制</strong> 将所选图形在原地复制一次，相当于复制后，又将图形的位置挪动到与被复制图形一样，因此该操作进行后，PPT界面显示不出来任何变化。某些情况下，我们需要将图形或者图片原位复制一份，用于一些特殊效果的设置。</p>
        <h4 id="CurveOffset">图形编辑 - 曲线操作</h4>
        <p>图形编辑功能下有一系列曲线的操作功能，包括：偏移、连接、拆分、曲线交点、节点优化。</p>
        <img class="leftImg" alt="" src="images/02002-1.png" />
        <p><strong>线条偏移</strong>该功能可以将线条（包括直线、折线、曲线、或者组合类型线条）按指定的方向及指定的距离进行偏移。需要说明的是，PPT中的曲线均为3次贝塞尔曲线，这类曲线无法精确偏移为另一条贝塞尔曲线，只能通过拆分曲线后尽可能的近似偏移。因此偏移线条的曲线的节点会增多。当设置的偏移量过大的时候，偏移线条会出现自相交的情况，此时偏移的曲线情况较为复杂，程序会尽可能的检查子相交情况，并进行处理。但当曲线本身节段较小的时候，处理自相交问题会变得更复杂，可能导致偏移的结果不正确。</p>
        <div class="remark">
            <p><strong>关于曲线偏移的特别说明：</strong></p>
            <ol>
                <li>曲线偏移为近似偏移，在平坦的地方较为精确，在曲率变化大的地方精确度较差；</li>
                <li>使用该功能偏移存在极小节段的曲线线条时，偏移功能可能因节段过小，出现偏移误差，得到不正确或者不满意的结果；</li>
                <li>偏移过程计算量较大，不建议对节点密集的曲线对象进行偏移操作。</li>
            </ol>
        </div>
        <p><strong>线条连接</strong>该功能可以将选择的线条、曲线按照选择的顺序进行连接。该操作的选择顺序十分重要，因为程序总是按照顺序来连接线条。当选择两条以上线段时，程序尝试将两条选择顺序相邻的线条最靠近的一段连接，如此直到所有线条连接，最后将线条的收尾端点相连。当线条之间起终点并不重合时，程序补充直线连接。连接线条继承第一个线条对象的特性。</p>
        <p><strong>线条拆分</strong>该功能可以将选择的线条用所选的直线进行拆分，所以实际相交的交点才会作为拆分点拆分，而未延长线上的交点不会被用于拆分。拆分时，程序会标定拆分点。</p>
        <p><strong>曲线交点</strong>该功能可以标定选择的两条线条之间的交点。程序所有用的寻找曲线交点的方法并非基于计算，而是基于像素交集分析得到，因此当两条曲线几乎重合的时候，此方法会返回大量的交点。直线的交点则基于计算给出，如果直线重合或平行则不会返回任何交点。本功能只支持自由曲线对象，如要标定直线与曲线的交点，请用多段线模式绘制直线。交点样式由程序自动生成圆形的点对象。</p>
        <p><strong>节点优化：</strong>本程序可用于优化节点过多，过于密集以至于影响编辑性的图形。例如，某些程序导入的图线，为了逼近曲线效果，可能会存在大量的节点，但其实这些节点过密，并无实际意义。通过此功能，可将这类曲线的节点极大的减少，从而改善可编辑性。优化最大节段长度可通过插件设置进行调整。本功能对于曲率变化平缓的图线优化效果良好，但是对于曲率凸变，且凸变的节段较小的情况下，优化效果并不理想。</p>
        <p><strong>节点拆分</strong>将所选的多段线或者曲线对象，按照节点位置进行拆分，拆分后的对象为新绘制的对象，继承拆分前对象的特性，可以根据设置选择保留拆分前的对象或者删除。</p>
        
        <h4>特殊图形</h4>
        <img class="leftImg" alt="" src="images/02003.png" />
        <p>在程序的编写过程中，作者发现PPT内置的图形要比通过程序界面可以选择绘制图形多，这些图形可以在通过插入SmartArt等组合图形时候获得，但是不能单独插入。而且当解散SmartArt获得该图形，则这个图形的调节点将丢失，因此本程序特别将其汇总，提供一个可以直接插入该类图形的接口。</p>
        <p>这些图形包括：6齿齿轮、9齿齿轮、不等腰梯形、双向箭头、趋势箭头、漏斗、圆弧双箭头以及一些角块图形。PPT并未提供输入控制的接口，因此仅能通过点击功能界面上的图形按钮，程序将会在幻灯片中间位置以程序默认的大小插入该图形。</p>
        
        <h4 id="SpecialCurves">特别的曲线</h4>
        <img class="leftImg" alt="" src="images/02003-1.png" />
        <p>该功能提供绘制12种闭合曲线、2种非闭合的螺旋图案。闭合曲线包括：玫瑰曲线、李萨如曲线、毛瑞尔玫瑰曲线、贝壳形曲线、盆形曲线、领结形曲线、星形曲线、耳蜗形曲线、圆形花曲线、幸运草曲线、外轮旋线、内轮旋线；非闭合曲线包括：等速螺旋、等角螺旋</p>
        <p><strong>曲线参数：</strong>每选择一种曲线类型，然后设置参数，点击绘制即可以绘制一个该类的图形。每种曲线的参数会控制曲线的形状大小、样式及周期性，但并非精确描述。例如玫瑰曲线的参数N，影响花瓣的数量，当N为偶数是，花瓣数其实为2N，N为奇数时，花瓣数为N。每个参数都有范围限制以及小数位限制，并不能任意输入。对于周期比类型的参数，对曲线是一种双控效果，实际控制曲线的是两个参数的比值。当周期比参数互质的时候，曲线最为繁复。当参数比值约简后相同，则曲线样式相同。例如李萨如曲线的N、M参数设置为20与5，效果同4与1。</p>
        <p><strong>优化节点：</strong>由于本程序是通过多段线模拟的曲线样式，每个节点之间是通过直线相连，为了保证平滑性，对称性，因此曲线的节点设置可能很多。尤其是在周期比参数很大，且互质的情况下，可以采取一定的优化措施。优化功能参考图形编辑中的节点优化说明。优化节点后的参数可设置优化节段的最大长度，单位为磅。</p>
        <div class="remark">
            <p><strong>关于特殊曲线的特别说明：</strong></p>
            <ol>
                <li>部分图形对参数变化十分敏感，即使相差最小的间隔也会产生明显变化；</li>
                <li>图形在设置较大的参数，且参数互质的情况下，生成图形节点数量会增大，图线会变的十分密集，尝试编辑图形的节点时，可能会导致PPT卡顿。</li>
            </ol>
        </div>
        
        <h4>直线与延伸</h4>
        <p>本功能包含五项子功能，直线延伸相交、直线微偏校正、图形对象的水平延伸、垂直延伸以及文本对齐到直线。本功能设置的应用场景之一为，手动绘制流程图、组织架构图等，需要将绘制的直线对齐，以及将内容框对齐到直线等操作。</p>
        <img class="leftImg" alt="" src="images/02004.png" />
        <p><strong>直线延伸相交</strong>，要求选择2个通过PowerPoint绘图界面<strong>直线或直线连接符</strong>绘制的图形，程序会将两个图形进行延伸相交</p>
        <p><strong>直线微偏校正</strong>，依然要求选择直线对象，当直线对象轻微偏离水平方向或者轻微偏离垂直方向，程序会将直线校正到水平方向或者垂直方向。微偏程度设定为直线两端的水平或垂直偏差距离与直线长度之比小于5%时，认定为微偏。</p>
        <p><strong>图形的水平延伸与垂直延伸</strong>，要求选择两个图形对象，程序会将先选择的图形延伸到后选择的图形的边界。注意选择顺序的不同，确定了延伸方式的不同。需要说明的是，程序只是简单的将图形的宽度、高度属性做了修改，对于矩形这类图形而言，延伸效果更好。</p>
        <p><strong>对齐到直线</strong>，该功能主要针对文本对象进行操作。所选择对象需要一个文本框以及一个直线对象。无论直线以何种方式绘制（指从上至下或者从下至上），文字对象均以左偏阅读的方式进行对齐，即文本对象的旋转角度为90&#176~-90&#176之间。</p>
        
        <h4 id="ExtendToEdge">延伸至边界</h4>
        <p>本程序可将选中的图形延伸至幻灯片页面的边缘。设计的使用场景为，当需要绘制一些图形，这些图形需要它延伸至幻灯片的边界，作为部分的背景覆盖时；或者更改了幻灯片文档的页面尺寸，导致原来设计的覆盖至边界的图形并没有扩展到新页面的边界等情况。使用该功能之前，应打开延伸设置界面，确定需要延伸的边界后，再进行延伸操作。</p>
        <img alt="" src="images/02005.png" />
        <p>延伸操作可以设置上下左右任意边界或部分边界的组合。该设置会保存直至退出PowerPoint程序或更改设置。每次开启PowerPoint程序时的默认设置为延伸至四边。</p>
        
        <h4 id="BitmapToVector">转矢量图</h4>
        <p>特别申明：本功能Potrace程序代码来源于Github的开源代码，作者：Dalton Spillman，开源地址：<a href="https://github.com/daltonks/BitmapToVector">https://github.com/daltonks/BitmapToVector</a>，开源协议GPL-3.0。</p>
        <p>本功能应用场景为，当需要设计一个文字形状的图形时，或者需要将较小的，并不具备放大条件的位图使用到文档中，希望它更清晰，甚至可以调整它的填充颜色时的情形。本功能的操作界面如下：</p>
        <img alt="" src="images/02006.png" />
        <p>本功能主要分为2个部分，一部分是将文字内容转换为矢量图线，另一部分是将图片内容转化为矢量图线。所有的矢量图形最后都以PowerPoint的自由曲线输出。</p>
        <p><strong>文字转换步骤</strong></p>
        <p>输入文字内容，选择字体及样式，并输入字体大小后，点击创建即可生成文字的矢量图线。字体大小范围为50~300磅。</p>
        <p>原则上，程序不设置输入的文字数量，但过长的文字内容可能造成程序出现不能意料的问题，建议每次输入的文字数量不要太多。每次输入的文字会作为一个整体生成图线。</p>
        <p><strong>图片转换步骤</strong></p>
        <p>本功能可将图片转化为PowerPoint多段线绘制的图形，但在转化为矢量图线前，程序会将图片进行灰度变换，再根据颜色调整值，保留一部分信息，删除一部分信息，然后开始进行矢量转换。本功能适合色彩边界明显，线条清晰的图形，或者黑白二色图形的转换。</p>
        <p>支持的图形包括Bmp、Jpg、Png格式的图形。</p>
        <p><strong>颜色调整：</strong>调整范围1~255。图片通过灰度变换后所有像素颜色值均RGB均相等，如果该值大于设定值，则转换为黑白图片后像素为白色，即忽略信息，小于该值则像素为黑色，保留信息。</p>
        <p><strong>忽略杂点：</strong>调整范围1~1000。通过程序转矢量的过程中，如果图形面积（像素点数量）小于设定的值，将将忽略该信息。通过调整该值，可以有效减少转换后矢量图形的杂点。如下图：左一为原图，中、右两图均为输出图线，颜色调整值均为5，中图为杂点设置为5，右图杂点设置为50。</p>
        <img alt="" src="images/02006-1.png" />
        <div class="remark">
            <p><strong>关于转矢量图功能特别说明：</strong></p>
            <ol>
                <li>本功能实时预览时，每次调整颜色值时，程序会更新预览显示，但是对于较大的图片而言，会造成程序运行缓慢，可能有卡顿感。建议对于大图言，先设置好参数，再单击预览按钮预览；</li>
                <li>颜色值越大，保留的信息越多，但是并不意味着信息多图形就会清晰，反而会因为无颜色区分，混成一团，什么也分不清楚；</li>
                <li>忽略杂点设置并不直接体现在预览界面，只有转换后才能得到最终的效果，如果预览界面出现较多很小的细密黑点时，适当的调整杂点范围，可以减少这些点生成图线；</li>
            </ol>
        </div>
        
        <h4>分布与阵列</h4>
        <img class="leftImg" alt="" src="images/02007.png" />
        <p>该部分包含4类功能：图形分布、图形阵列、圆形阵列、曲线阵列。每个功能都有相应的UI设置界面进行操作设置。</p>
        <p>功能应用场景为：需要整齐排布图形对象时，或者需要通过复制变位设计一些创意的背景图形，或者图文排布时。</p>
        
        <h4 id="ShapeLayout">图形分布</h4>
        <img class="leftImg" alt="" src="images/02007-1.png" />
        <p>该功能针对多图形进行操作，最少需要选择2个对象。可以设定以行排列方式或者以列排列方式来进行分布。当设置行最大数量时，程序将所有图形先按行排列，当超出设置的行最大数量时，则转下一行继续排列，当设置为0时，表示不显示，此时所有图形排列为1行。以列为排列优先方式排列时，与行排列规则类似。无论以行优先排列或者以列优先排列，均以设定的行间距和列间距进行排列。间距可以设定为负值。</p>
        <p><strong>尺寸调整</strong></p>
        <p>设定为原始尺寸时，程序不会调整图形的尺寸。行排列优先时，对象行间距为设定的行间距，对象列间距指相邻两行的最小值；而列优先时，对象的列间距为设定的列间距，对象的行间距指相邻两列的最小值。设定为自定义尺寸时，如果宽与高其中之一为0，另一个不为零，则程序按照锁定高宽比模式进行高宽修改，如果都不为0，则程序将解除高宽比锁定，强制修改所有的图形尺寸为指定的自定义尺寸。如果都为0，则不做任何修改，等同于使用原始尺寸。</p>
        <p>下图展示了以行优先形式进行排列，每行最大图形数量不超过5个，且不调整原始图形的尺寸。</p>
        <img alt="" src="images/02007-1-1.png" />
        <div class="remark">
            <p><strong>关于图形分布功能特别说明：</strong></p>
            <ol>
                <li>有时，间距为负并不意为着所见的图形重叠，例如对于“&gt”形状的图形，负间距会让它们显得更加靠近而不是重叠。但它们的边界矩形是重叠在一起的；</li>
                <li>对旋转角度不为0&#176的图形进行分布，可能会得到意外的阵列结果。主要为，经过旋转，图形的位置与视觉所见的位置并不是一致的，因此会造成程序完成后所得结果并非视觉所见效果。</li>
            </ol>
        </div>
        
        <h4 id="ShapeArray">图形阵列</h4>
        <img class="leftImg" alt="" src="images/02007-2.png" />
        <p>图形阵列为将所选的单一图形进行水平或垂直方向的复制阵列。阵列的方向为水平从左向右，垂直从上至下阵列。间距与图形分布的间距意义相同，指图形界限矩形的间距，可以为负值。</p>
        <p><strong>变换选项</strong></p>
        <p>变换提供了3种变换类型：大小、角度、波形变换。可以三种变换组合进行或者单一进行。</p>
        <p><strong>蜂窝网格</strong></p>
        <p>选择一个六边形，将其阵列为蜂窝形状的网格图形。蜂窝网格阵列时，仅能指定行间距，且行间距用于控制六边形之间的间隔距离。对于阵列蜂窝网格操作时，变换功能将禁用。</p>
        <br>
        <p>下图展示无变换阵列，单一缩放变换阵列以及组合变换阵列：</p>
        <img alt="" src="images/02007-2-1.png" />
        <p>下图展示蜂窝网格的阵列：</p>
        <img alt="" src="images/02007-2-2.png" />
        <div class="remark">
            <p><strong>关于图形阵列功能特别说明：</strong></p>
            <ol>
                <li>当同时进行缩放、波形变换时，幅度的计算是针对为缩放前的波长而言，对于缩小变换，幅度会比设置的数值偏大，对于放大而言，幅度会比设置的数值偏小；</li>
                <li>对旋转角度不为0&#176的图形进行阵列，可能会得到意外的阵列结果。主要为，经过旋转，图形的位置与视觉所见的位置并不是一致的，因此会造成阵列结果并非想要的结果。</li>
            </ol>
        </div>
        
        <h4 id="CircleArray">圆形阵列</h4>
        <img class="leftImg" alt="" src="images/02007-3.png" />
        <p>选中一个图形，将其绕指定半径的圆形路径进行复制阵列。圆形路径为：以所选图形中心位置垂直向下一个指定半径长度的点为中心，以指定半径绘制的圆形。相对于圆形路径而言，阵列总是从圆的顶部开始，顺时针进行。或者选中2个图形，将第一个图形绕第二个图形中心进行圆形阵列。</p>
        <p><strong>围绕第二选图形中心</strong>勾选时，不能设定半径，将使用两个图形中心距离作为半径进行圆形阵列。</p>
        <p><strong>终角</strong>指阵列结束时路径经历过的角度，最小5&#176，最大360&#176。该角度的设定会影响图形最大数量的设定。图形的数量设置不能超过角度设置的数值，即，每次转过的最小角度不小于1&#176。</p>
        <p><strong>缩放变换</strong>类似于图形阵列的变换，在进行圆形阵列时，对图形进行缩放变换。</p>
        <p><strong>不旋转图形</strong>即为保持源图形的旋转角度，不跟随旋转阵列进行旋转。默认情况下，图形会根据阵列旋转过的角度进行旋转。</p>
        <p>绘制路径圆即将上述的路径圆形绘制出来。下图所示三角形，在不同选项下的阵列效果：</p>
        <img alt="" src="images/02007-3-1.png" />
        <div class="remark">
            <p><strong>关于圆形阵列功能特别说明：</strong></p>
            <ol>
                <li>由于图形旋转角度最小单位为1&#176，因此，阵列数目较多的情况下，可能因为计算舍入，造成结果偏差；</li>
                <li>当阵列数量能被阵列角度整除时，可以获得最佳的阵列效果。</li>
            </ol>
        </div>
        
        <h4 id="CurveArray">曲线阵列</h4>
        <img class="leftImg" alt="" src="images/02007-4.png" />
        <p>该功能包含3中阵列模式：<strong>按数量阵列、按距离阵列、文本阵列</strong>，其中按数量阵列、按距离阵列均需要选择一个自由曲线对象和一个图形对象进行操作，曲线作为阵列路径，而图形对象则作为源图形沿路径进行阵列。而文本阵列则仅需要选择一个自由曲线对象作为路径操作。</p>
        <p><strong>对齐到线路</strong>选项对于按数量阵列与按距离阵列操作均有效设置，但文本阵列强制对齐到线路。</p>
        <p>文本阵列内容原则为一段文字，换行操作由程序根据路径长度计算，不受文本的换行符控制，且换行符按空白位置输出。</p>
        <p>文本拆分阵列时，其大小与字体设置的大小只能表明正相关性，但不是绝对的对等性。即设置30磅的字体，在不同的字体样式下，字图形的高度未必精确为30磅，因此程序通过字符的实际绘制大小来进行控制调节。受限于字体的内部设置，其设定的字体大小与外观表现可能并不一致，因此程序提供了字宽、字高的缩放系数，用于调节阵列时的间距。</p>
        <p>以下为各类阵列的示例：</p>
        <img alt="" src="images/02007-4-1.png" />
        <div class="remark">
            <p><strong>关于曲线阵列功能特别说明：</strong></p>
            <ol>
                <li>阵列路径应总是曲线类型的对象，对于将自动图形转换为曲线之后的曲线对象，如为多条曲线的组合图形，则程序总选择第一条曲线对象作为路径执行操作；</li>
                <li>对于曲线而言，程序通过数值积分的办法获取曲线长度，如果路径中包含的曲线段数量很多，则会大大影响程序的运行效率，因此建议对曲线节点数量进行优化后再进行阵列操作；</li>
                <li>文本阵列需要测量指定字体下的文字宽度及高度，但是不同字形测得的尺寸与实际效果可能存在差距。</li>
            </ol>
        </div>
        
        <h4 id="ShapeReplace">图形替换</h4>
        <img class="leftImg" alt="" src="images/02007-5.png" />
        <p>本功能用于在当前幻灯片内，使用第二个选择的图形替换第一个选择的图形。</p>
        <p><strong>图形相同判断</strong>：程序首先进行图形的类型判断，大小判断，这类判断是强制的，如果类型不同或者大小不同，都不会认定为相同图形。更进一步，根据选择程序将进行轮廓线、线型、颜色、填充颜色、类型、调节点位置、内部文字进行判断。这些判断均与第一选择图形进行。</p>
        <p><strong>替换时对齐</strong>，指相对于被替换掉的图形而言，新图形对齐到被替换图形的哪个点位。</p>
        <p><strong>编组内替换</strong>，勾选时将替换编组内部的图形，不勾选时，编组将被略过。</p>
        
        <h4 id="ShapeLocationExchange">位置互换</h4>
        <p>本功能将所选的两个图形以各自中心点为参照进行位置互换。</p>
        
        <a href="index.html">返回首页</a>
    </body>
</html>
